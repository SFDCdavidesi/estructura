<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UAX - Estructura de Computadores</title>
    <style>
        :root {
            --primary: #2563eb;
            --success: #059669;
            --error: #dc2626;
            --bg: #f1f5f9;
            --card: #ffffff;
            --text: #0f172a;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            position: sticky;
            top: 0;
            background: var(--card);
            width: 100%;
            max-width: 500px;
            padding: 15px;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            z-index: 1000;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat { text-align: center; }
        .stat-val { display: block; font-weight: 800; font-size: 1.2rem; }
        .stat-label { font-size: 0.7rem; color: #64748b; text-transform: uppercase; }

        .shuffle-btn {
            grid-column: span 3;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 2px 4px rgba(37, 99, 235, 0.3);
        }

        .quiz-container { width: 100%; max-width: 500px; }

        .q-card {
            background: var(--card);
            padding: 18px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .unit-badge {
            background: #e2e8f0;
            color: #475569;
            padding: 2px 8px;
            border-radius: 5px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .question-text {
            font-size: 1rem;
            font-weight: 600;
            margin: 12px 0;
            line-height: 1.4;
        }

        .option {
            padding: 12px;
            border: 2px solid #f1f5f9;
            border-radius: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            background: #fdfdfd;
        }

        .disabled { pointer-events: none; }
        .correct { background: #dcfce7 !important; border-color: var(--success) !important; color: #166534; }
        .wrong { background: #fee2e2 !important; border-color: var(--error) !important; color: #991b1b; }

        #results-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 2000;
            width: 80%;
            max-width: 400px;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1999;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="stat"><span class="stat-val" id="hits">0</span><span class="stat-label">Aciertos</span></div>
        <div class="stat"><span class="stat-val" id="fails">0</span><span class="stat-label">Fallos</span></div>
        <div class="stat"><span class="stat-val" id="current">0/60</span><span class="stat-label">Progreso</span></div>
        <button class="shuffle-btn" onclick="initQuiz()">ðŸŽ² Mezclar y Reiniciar</button>
    </div>

    <div class="quiz-container" id="quiz-box"></div>

    <div class="overlay" id="overlay"></div>
    <div id="results-modal">
        <h2>ðŸŽ‰ Â¡Fin del Test!</h2>
        <div id="final-stats" style="margin: 20px 0; line-height: 2;"></div>
        <button class="shuffle-btn" onclick="initQuiz(); document.getElementById('results-modal').style.display='none'; document.getElementById('overlay').style.display='none';">ðŸ”„ Volver a intentar</button>
    </div>

    <script>
        const rawQuestions = [
            // UD1
            {u:"UD1", q:"Los transistores pertenecen a la generaciÃ³n de computadores...", o:["Tercera.", "Primera.", "Cuarta.", "Segunda."], c:3},
            {u:"UD1", q:"En una memoria (UD1):", o:["Tantos bits almacenados como 2^lÃ­neas.", "La cantidad total de datos almacenada es potencia de 2.", "En cada posiciÃ³n de memoria hay almacenado un dato Ãºtil.", "NÃºmero de posiciones es 2^bits de entrada."], c:1},
            {u:"UD1", q:"Como estudiantes reciÃ©n graduados... nos piden diseÃ±ar una computadora para un sistema empotrado, Â¿quÃ© arquitectura recomendarÃ­as?", o:["Un Macintosh.", "Harvard.", "Von Neumann.", "Un servidor Windows."], c:1},
            {u:"UD1", q:"Respecto a la arquitectura: Es von Neumann si el bus de datos y el de instrucciones es compartido.", o:["Verdadero", "Es Harvard si comparten bus.", "Falso", "Ninguna."], c:0},
            {u:"UD1", q:"Una memoria volÃ¡til se caracteriza por:", o:["Parte del computador donde se almacenan datos.", "Se pierde la informaciÃ³n si se interrumpe el flujo elÃ©ctrico.", "No necesita energÃ­a.", "Ninguna."], c:1},
            {u:"UD1", q:"El registro de instrucciÃ³n...", o:["Contiene valores de ejecuciÃ³n.", "Ninguna de las otras respuestas.", "Siguiente instrucciÃ³n en ensamblador.", "Actual instrucciÃ³n en ensamblador."], c:1},
            {u:"UD1", q:"Es Harvard si las instrucciones pueden tener distinto tamaÃ±o que los datos.", o:["Verdadero", "Falso", "Solo en Von Neumann", "Ninguna."], c:0},
            {u:"UD1", q:"El CP (contador de programa), Â¿a dÃ³nde apunta?", o:["A la siguiente instrucciÃ³n.", "A la instrucciÃ³n en curso.", "A la instrucciÃ³n previa.", "Ninguna."], c:0},
            {u:"UD1", q:"El lenguaje mÃ¡quina ...", o:["Ninguna.", "Es un lenguaje de bajo nivel.", "Es muy alto nivel.", "Es alto nivel."], c:1},
            {u:"UD1", q:"La primera generaciÃ³n de computadores se caracterizÃ³ por usar:", o:["Circuitos integrados.", "Tubos al vacÃ­o.", "Transistores.", "Chips."], c:1},

            // UD2
            {u:"UD2", q:"Respecto al reloj: Es difÃ­cil comparar dos procesadores de dos arquitecturas distintas.", o:["Verdadero", "Falso", "Solo por MIPS", "Solo por Frecuencia"], c:0},
            {u:"UD2", q:"Respecto al CPI: A mayor CPI menos MIPS.", o:["Verdadero", "Falso", "No dependen", "Solo en RISC"], c:0},
            {u:"UD2", q:"MIPS con 2 MHz y media de 3 instrucciones por ciclo:", o:["6.", "3/2.", "No se sabe.", "2000/3."], c:0},
            {u:"UD2", q:"SeÃ±ala la FALSA: La velocidad de reloj permite comparar arquitecturas.", o:["Cierto", "Falso", "Es la respuesta falsa", "Depende del CPI"], c:2},
            {u:"UD2", q:"Verdadera: Los procesadores superescalares se utilizan en tareas intensivas de cÃ¡lculo.", o:["Falso", "Solo en mÃ³viles", "Verdadero", "Solo en servidores"], c:2},
            {u:"UD2", q:"Un ciclo de 1 ns son:", o:["10 G.", "1 G.", "No se sabe.", "2 G."], c:1},
            {u:"UD2", q:"Respecto al CPI: No aporta nada sobre la rapidez de ejecuciÃ³n de los programas.", o:["Cierto", "Falso", "Depende", "Solo en CISC"], c:0},
            {u:"UD2", q:"Los MFLOPS: EstÃ¡n relacionados con el CPI.", o:["Verdadero", "Falso", "Son universales", "Miden todo"], c:0},
            {u:"UD2", q:"FALSA: Los multicomputadores tienen memoria compartida.", o:["Cierto", "Es falsa", "Tienen nodos", "Paso de mensajes"], c:1},
            {u:"UD2", q:"SegmentaciÃ³n: Se puede solucionar dependencias con instrucciones NOP.", o:["Verdadero", "Falso", "Solo hardware", "Solo software"], c:0},

            // UD3
            {u:"UD3", q:"El lenguaje ensamblador: Se llama de bajo nivel porque estÃ¡ mÃ¡s cerca del hardware.", o:["Cierto", "Falso", "Medio nivel", "Alto nivel"], c:0},
            {u:"UD3", q:"MIPS32 tiene un conjunto reducido de instrucciones.", o:["Verdadero", "Falso (CISC)", "Es complejo", "No tiene"], c:0},
            {u:"UD3", q:"Â¿QuÃ© instrucciÃ³n en MIPS32 se utiliza para sumar dos registros?", o:["SUB", "ADD", "DIV", "MUL"], c:1},
            {u:"UD3", q:"Direccionamiento indirecto a registro con desplazamiento utiliza base + desplazamiento.", o:["Falso", "Cierto", "Solo inmediato", "Solo directo"], c:1},
            {u:"UD3", q:"Verdadera: El cÃ³digo mÃ¡quina en memoria se ejecuta sin compilador.", o:["Falso", "Cierto", "Necesita Linker", "Necesita Assembler"], c:1},
            {u:"UD3", q:"Little Endian: El byte menos significativo se coloca en la primera posiciÃ³n.", o:["Cierto", "Falso", "Aleatorio", "Ãšltima posiciÃ³n"], c:0},
            {u:"UD3", q:"MIPS32: Su arquitectura es de carga/almacenamiento.", o:["Cierto", "Falso", "Es CISC", "Solo memoria"], c:0},
            {u:"UD3", q:"PseudoinstrucciÃ³n: El ensamblador la traduce a una o mÃ¡s instrucciones mÃ¡quina.", o:["Falso", "Cierto", "Es ilegal", "Solo kernel"], c:1},
            {u:"UD3", q:"Ensamblador: Es muy parecido entre procesadores distintos, aunque depende de la arquitectura.", o:["Falso", "Cierto", "IdÃ©ntico", "Diferente"], c:1},
            {u:"UD3", q:"MIPS32: El modo kernel tiene mÃ¡s permisos sobre el hardware.", o:["Cierto", "Falso", "Igual que usuario", "No existe"], c:0},

            // UD4
            {u:"UD4", q:"CÃ³digo 'mul $t2, $t0, $t1': Multiplica a y b y almacena en c.", o:["Cierto", "Suma", "Resta", "Divide"], c:0},
            {u:"UD4", q:"'lb' en MIPS32: Carga un byte extendiÃ©ndolo con signo.", o:["Almacena", "Carga palabra", "Cierto", "Sin signo"], c:2},
            {u:"UD4", q:"CÃ³digo 'sub $t2, $t0, $t1': Resta el valor de b de a.", o:["Suma", "Cierto", "Multiplica", "Divide"], c:1},
            {u:"UD4", q:"Cargar byte extendiÃ©ndolo con ceros (sin signo):", o:["lbu", "lw", "lb", "sb"], c:0},
            {u:"UD4", q:"beq/bne: Compara x e y, almacena 1 en z si son iguales, sino 0.", o:["Suma", "Resta", "Cierto", "Falso"], c:2},
            {u:"UD4", q:"Cargar una palabra desde memoria a registro:", o:["lb", "sb", "sw", "lw"], c:3},
            {u:"UD4", q:"Cargar valor inmediato en un registro:", o:["sw", "sb", "li", "lw"], c:2},
            {u:"UD4", q:"Formato de instrucciones en MIPS32:", o:["Variable", "Fijo 32 bits.", "Fijo 64 bits", "8 bits"], c:1},
            {u:"UD4", q:"Almacenar un byte desde registro en memoria:", o:["sw", "sb", "lb", "lw"], c:1},
            {u:"UD4", q:"'div' y 'mfhi $t2': Divide val por 4 y almacena el residuo.", o:["Cociente", "Cierto", "Suma", "Resta"], c:1},

            // UD5
            {u:"UD5", q:"Unidad de control: Gestiona y coordina las operaciones.", o:["E/S", "Cierto", "Almacena", "ALU"], c:1},
            {u:"UD5", q:"MIPS32 tiene un ancho del bus de direcciones de 4 bytes.", o:["Cierto", "Falso", "8 bytes", "2 bytes"], c:0},
            {u:"UD5", q:"Unidad de control: Puede cambiar el salto a su siguiente estado segÃºn ruta datos.", o:["Falso", "Cierto", "Sin reloj", "No puede"], c:1},
            {u:"UD5", q:"Reloj: Es una seÃ±al cuadrada (ceros y unos).", o:["Sinusoidal", "Sierra", "Cierto", "Cualquier forma"], c:2},
            {u:"UD5", q:"Un ciclo de 1 ns es 1 G de frecuencia.", o:["Cierto", "Falso", "2 G", "10 G"], c:0},
            {u:"UD5", q:"Bus: LÃ­neas de transmisiÃ³n que permiten comunicaciÃ³n hardware.", o:["Disco", "Cierto", "RAM", "E/S"], c:1},
            {u:"UD5", q:"FETCH: Se busca la instrucciÃ³n en la memoria principal.", o:["Ejecuta", "Cierto", "Decodifica", "Almacena"], c:1},
            {u:"UD5", q:"Fase Fetch (UD5): Carga datos de memoria.", o:["Cierto", "Hacia memoria", "No memoria", "Solo registros"], c:0},
            {u:"UD5", q:"Ruta de datos: Contiene registros.", o:["Falso", "Moore", "Cierto", "Solo cables"], c:2},
            {u:"UD5", q:"ALU: Solamente opera con registros.", o:["Con memoria", "Cierto", "Pone a cero", "Directo a disco"], c:1},

            // UD6
            {u:"UD6", q:"Memoria volÃ¡til: Pierde los datos cuando se apaga el sistema.", o:["Cierto", "Falso", "CachÃ©", "Flash"], c:0},
            {u:"UD6", q:"Fallo de cachÃ©: Bloque solicitado no se encuentra en cachÃ©.", o:["Cierto", "Falso", "Permanente", "Ya estÃ¡"], c:0},
            {u:"UD6", q:"Memoria mÃ¡s rÃ¡pida y cara:", o:["SRAM", "Flash", "DRAM", "Disco"], c:0},
            {u:"UD6", q:"Localidad espacial: Si se accede a un dato, se accederÃ¡ a cercanos.", o:["Temporal", "Cierto", "Aleatorio", "Directo"], c:1},
            {u:"UD6", q:"MÃ³dulo E/S FALSA: Nunca almacena datos.", o:["Es falsa", "Cierto", "Gestiona CPU", "Temporiza"], c:0},
            {u:"UD6", q:"Tipo de memoria volÃ¡til (UD6):", o:["Flash", "ROM", "Discos", "RAM"], c:3},
            {u:"UD6", q:"Reemplazo aleatorio: Selecciona al azar el bloque.", o:["LRU", "Cierto", "FIFO", "Directo"], c:1},
            {u:"UD6", q:"Programa: Se ejecutan leyendo las instrucciones de memoria principal.", o:["Del disco", "Cierto", "Compila", "Alto nivel"], c:1},
            {u:"UD6", q:"Memoria externa, alta capacidad y bajo costo:", o:["Ã“ptica.", "Semiconductores.", "MagnÃ©tica.", "Flash."], c:2},
            {u:"UD6", q:"CachÃ©: Almacena temporalmente los datos mÃ¡s usados.", o:["Cierto", "Permanente", "Externa", "Lenta"], c:0}
        ];

        let questions = [];
        let hits = 0, fails = 0, done = 0;

        // Algoritmo Fisher-Yates corregido
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                const temp = array[i];
                array[i] = array[j];
                array[j] = temp;
            }
        }

        function initQuiz() {
            questions = JSON.parse(JSON.stringify(rawQuestions));
            shuffle(questions);
            hits = 0; fails = 0; done = 0;
            updateStats();
            render();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function updateStats() {
            document.getElementById('hits').innerText = hits;
            document.getElementById('fails').innerText = fails;
            document.getElementById('current').innerText = `${done}/${questions.length}`;
        }

        function render() {
            const box = document.getElementById('quiz-box');
            box.innerHTML = '';
            questions.forEach((data, i) => {
                const card = document.createElement('div');
                card.className = 'q-card';
                card.innerHTML = `
                    <span class="unit-badge">${data.u}</span>
                    <div class="question-text"><strong>${i+1}.</strong> ${data.q}</div>
                    <div class="options-container" id="opts-${i}">
                        ${data.o.map((opt, oi) => `<div class="option" onclick="check(${i}, ${oi})">${opt}</div>`).join('')}
                    </div>
                `;
                box.appendChild(card);
            });
        }

        window.check = (qi, oi) => {
            const container = document.getElementById(`opts-${qi}`);
            if(container.classList.contains('disabled')) return;
            
            const options = container.querySelectorAll('.option');
            const correct = questions[qi].c;
            
            if(oi === correct) {
                options[oi].classList.add('correct');
                hits++;
            } else {
                options[oi].classList.add('wrong');
                options[correct].classList.add('correct');
                fails++;
            }
            
            done++;
            container.classList.add('disabled');
            updateStats();

            if(done === questions.length) showFinalResults();
        };

        function showFinalResults() {
            const grade = ((hits / questions.length) * 10).toFixed(2);
            document.getElementById('final-stats').innerHTML = `
                <div style="font-size: 1.1rem">
                    Aciertos: <span style="color:var(--success)">${hits}</span><br>
                    Fallos: <span style="color:var(--error)">${fails}</span><br>
                    Nota Final: <span style="font-size:2rem; font-weight:bold">${grade} / 10</span>
                </div>
            `;
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('results-modal').style.display = 'block';
        }

        initQuiz();
    </script>
</body>
</html>